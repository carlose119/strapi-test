<div class="rendered-form">
  <form id="contactos" method="post">
    <div class="formbuilder-text form-group field-username">
      <label for="nombre" class="formbuilder-text-label">nombre</label>
      <input type="text" class="form-control" name="Nombre" access="false" id="nombre">
    </div>
    <div class="formbuilder-text form-group field-email">
      <label for="email" class="formbuilder-text-label">email</label>
      <input type="email" class="form-control" name="email" access="false" id="email">
    </div>
    <div class="formbuilder-text form-group field-password">
      <label for="mensaje" class="formbuilder-text-label">mensaje</label>
      <input type="text" class="form-control" name="Mensaje" access="false" id="mensaje">
    </div>

    <div class="formbuilder-button form-group field-submit">
      <!--  <button type="submit" class="btn-default btn" name="submit" value="submit" access="false"
        id="submit">submit</button> -->
      <button type="button" class="g-recaptcha btn-default btn" data-sitekey="6LcqxzcpAAAAAMCkL5Z_-rK1jqZsbwHp5tPOvapD"
        data-callback='onSubmit' data-action='submit'>Submit</button>
    </div>
  </form>
</div>
<script>
  document.getElementById('contactos').addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const data = Array.from(formData.entries()).reduce((memo, pair) => ({
      ...memo,
      [pair[0]]: pair[1],
    }), {});
    const xhr = new XMLHttpRequest();
    xhr.open('POST', 'auth/local/register', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(JSON.stringify(data));
  });
</script>


<script src="https://www.google.com/recaptcha/api.js"></script>
<script>
  function onSubmit(token) {
    //document.getElementById("contactos").submit();

    const endpoint = 'http://localhost:1337/api/contactos';
    const formElement = document.getElementById("contactos");
    const formData = new FormData(formElement);
    let data = Array.from(formData.entries()).reduce((memo, pair) => ({
       ...memo,
       [pair[0]]: pair[1],
     }), {});
    data = {
      data
    };
    console.log(data);
    const xhr = new XMLHttpRequest();
    xhr.open('POST', endpoint, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(JSON.stringify(data));
  }
</script>
